!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.jsorm={})}(this,function(t){"use strict";var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};function s(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var i=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t};function e(t,e,r,n){var i,o=arguments.length,s=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,r,n);else for(var a=t.length-1;0<=a;a--)(i=t[a])&&(s=(o<3?i(s):3<o?i(e,r,s):i(e,r))||s);return 3<o&&s&&Object.defineProperty(e,r,s),s}function a(o,s,a,u){return new(a||(a=Promise))(function(t,e){function r(t){try{i(u.next(t))}catch(t){e(t)}}function n(t){try{i(u.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(r,n)}i((u=u.apply(o,s||[])).next())})}function c(r,n){var i,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=o[2&e[0]?"return":e[0]?"throw":"next"])&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[0,s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=n.call(r,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}var r,o=function(){function r(t,e){this.model=t,this.payload=e}return r.apply=function(t,e){new r(t,e).apply()},r.prototype.apply=function(){var n=this,i={};this.payload.errors&&(this.payload.errors.forEach(function(t){var e=t.meta,r=e.relationship;r?n._processRelationship(n.model,r,t):n._processResource(i,e,t)}),this.model.errors=i)},r.prototype._processResource=function(t,e,r){var n=this.model.klass.deserializeKey(e.attribute);t[n]={title:r.title,code:r.code,attribute:e.attribute,message:e.message,fullMessage:"base"===n?e.message:r.detail,rawPayload:r}},r.prototype._processRelationship=function(t,e,r){var n=t[e.name];if(Array.isArray(n)&&(n=n.find(function(t){return t.id===e.id||t.temp_id===e["temp-id"]})),e.relationship)this._processRelationship(n,e.relationship,r);else{var i={};this._processResource(i,e,r);var o={};Object.keys(n.errors).forEach(function(t){o[t]=n.errors[t]}),Object.keys(i).forEach(function(t){var e=i[t];void 0!==e&&(o[t]=e)}),n.errors=o}},r}(),u=function(t,e){var r=e.headers.get("X-JWT");r&&t.setJWT(r)},l={green:[32,39],cyan:[36,39],magenta:[35,39],bold:[1,22]},p=function(t,e){if(f()){var r=l[t];return"["+r[0]+"m"+e+"["+r[1]+"m"}return e},f=function(){return void 0===typeof window&&!!/^screen|^xterm|^vt100|color|ansi|cygwin|linux/i.test(process.env.TERM)},h=function(){function t(t,e){this.middleware=t,this.logger=e}return t.prototype.get=function(t,e){return e.method="GET",this._fetchWithLogging(t,e)},t.prototype.post=function(t,e,r){return r.method="POST",r.body=JSON.stringify(e),this._fetchWithLogging(t,r)},t.prototype.patch=function(t,e,r){return r.method="PATCH",r.body=JSON.stringify(e),this._fetchWithLogging(t,r)},t.prototype.delete=function(t,e){return e.method="DELETE",this._fetchWithLogging(t,e)},t.prototype._logRequest=function(t,e){this.logger.info(p("cyan",t+": ")+p("magenta",e))},t.prototype._logResponse=function(t){this.logger.debug(p("bold",JSON.stringify(t,null,4)))},t.prototype._fetchWithLogging=function(r,n){return a(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return this._logRequest(n.method||"UNDEFINED METHOD",r),[4,this._fetch(r,n)];case 1:return e=t.sent(),this._logResponse(e.jsonPayload),[2,e]}})})},t.prototype._fetch=function(n,i){return a(this,void 0,void 0,function(){var e,r;return c(this,function(t){switch(t.label){case 0:try{this.middleware.beforeFetch(n,i)}catch(t){throw new d("beforeFetch failed; review middleware.beforeFetch stack",n,i,t)}t.label=1;case 1:return t.trys.push([1,3,,4]),[4,fetch(n,i)];case 2:return e=t.sent(),[3,4];case 3:throw r=t.sent(),new y(null,r.message,r);case 4:return[4,this._handleResponse(e,i)];case 5:return t.sent(),[2,e]}})})},t.prototype._handleResponse=function(n,i){return a(this,void 0,void 0,function(){var e,r;return c(this,function(t){switch(t.label){case 0:if("DELETE"===i.method&&-1<[202,204,200].indexOf(n.status))return[2];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.json()];case 2:return e=t.sent(),[3,4];case 3:throw r=t.sent(),new y(n,"invalid json",r);case 4:try{this.middleware.afterFetch(n,e)}catch(t){throw new y(n,"afterFetch failed; review middleware.afterFetch stack",t)}if(500<=n.status)throw new y(n,"Server Error");if(422!==n.status&&void 0===e.data)throw 404===n.status?new y(n,"record not found"):new y(n,"invalid json");return n.jsonPayload=e,[2]}})})},t}(),d=function(o){function t(t,e,r,n){var i=o.call(this,t)||this;return i.stack=n.stack,i.url=e,i.options=r,i.originalError=n,i}return s(t,o),t}(Error),y=function(i){function t(t,e,r){var n=i.call(this,e||"Invalid Response")||this;return n.response=t,n.originalError=r,n}return s(t,i),t}(Error),b=function(){function n(t){this.dct={};var e=this._parseIncludeArgs(t);for(var r in e)e.hasOwnProperty(r)&&(this.dct[r]=new n(e[r]))}return n.prototype.toScopeObject=function(){var t={};for(var e in this.dct)this.dct.hasOwnProperty(e)&&(t[e]=this.dct[e].toScopeObject());return t},n.prototype.toString=function(){var n=[],t=function(e){if(i.dct.hasOwnProperty(e)){var t=i.dct[e].toString();if(""===t)n.push(e);else{var r=t.split(",");r=r.map(function(t){return e+"."+t}),n.push(r.join(","))}}},i=this;for(var e in this.dct)t(e);return n.join(",")},n.prototype._parseIncludeArgs=function(t){if(Array.isArray(t))return this._parseArray(t);if("string"==typeof t){var e={};return e[t]={},e}return"object"==typeof t?this._parseObject(t):{}},n.prototype._parseObject=function(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(e[r]=this._parseIncludeArgs(t[r]));return e},n.prototype._parseArray=function(t){for(var e={},r=0,n=t;r<n.length;r++){var i=n[r],o=this._parseIncludeArgs(i);for(var s in o)o.hasOwnProperty(s)&&(e[s]=o[s])}return e},n}(),v=0,g=function(){return"temp-id-"+ ++v},_=function(){function s(t,e,r){void 0===r&&(r=!1),this.included=[],this.idOnly=!1;var n=new b(e);if(this.includeDirective=n.toScopeObject(),this.model=t,this.idOnly=r,!t.klass.jsonapiType)throw new Error("Cannot serialize model: Undefined jsonapiType");this.jsonapiType=t.klass.jsonapiType}return s.prototype.attributes=function(){var r=this,n={};return this._eachAttribute(function(t,e){r.model.isPersisted&&!r.model.changes()[t]||(n[r.model.klass.serializeKey(t)]=e)}),n},s.prototype.removeDeletions=function(o,s){var a=this;Object.keys(s).forEach(function(r){var n=s[r],i=o,t=i[r];if(t)if(Array.isArray(t))t.forEach(function(t,e){t.isMarkedForDestruction||t.isMarkedForDisassociation?i[r].splice(e,1):a.removeDeletions(t,n)});else{var e=t;e.isMarkedForDestruction||e.isMarkedForDisassociation?i[r]=null:a.removeDeletions(e,n)}})},s.prototype.postProcess=function(){this.removeDeletions(this.model,this.includeDirective),this.model.resetRelationTracking(this.includeDirective)},s.prototype.relationships=function(){var o=this,s={};return Object.keys(this.includeDirective).forEach(function(e){var r,n=o.includeDirective[e],i=!1;-1<e.indexOf(".")&&(e=e.split(".")[0],i=!0);var t=o.model[e];t&&(Array.isArray(t)?(r=[],t.forEach(function(t){(i||o.model.hasDirtyRelation(e,t)||t.isDirty(n))&&r.push(o._processRelatedModel(t,n,i))}),0===r.length&&(r=null)):(i||o.model.hasDirtyRelation(e,t)||t.isDirty(n))&&(r=o._processRelatedModel(t,n,i)),r&&(s[o.model.klass.serializeKey(e)]={data:r}))}),s},s.prototype.asJSON=function(){var t={type:this.jsonapiType};if(this.model.id&&(t.id=this.model.id),this.model.temp_id&&(t["temp-id"]=this.model.temp_id),!this.idOnly){var e=this.attributes();0<Object.keys(e).length&&(t.attributes=e)}var r=this.relationships();0<Object.keys(r).length&&(t.relationships=r);var n={data:t};return 0<this.included.length&&(n.included=this.included),n},s.prototype._processRelatedModel=function(t,e,r){var n=this;t.clearErrors(),t.isPersisted||(t.temp_id=g());var i=new s(t,e,r),o=i.asJSON().data;return this._pushInclude(o),i.included.forEach(function(t){n._pushInclude(t)}),this._resourceIdentifierFor(t)},s.prototype._resourceIdentifierFor=function(t){if(!t.klass.jsonapiType)throw new Error("Cannot serialize model: Undefined jsonapiType for model "+t);var e,r={type:t.klass.jsonapiType};return t.id&&(r.id=t.id),t.temp_id&&(r["temp-id"]=t.temp_id),e=t.isPersisted?t.isMarkedForDestruction?"destroy":t.isMarkedForDisassociation?"disassociate":"update":"create",r.method=e,r},s.prototype._pushInclude=function(t){this._isIncluded(t)||this.included.push(t)},s.prototype._isIncluded=function(e){return this.included.forEach(function(t){if(t.type===e.type&&(t.id===e.id||t["temp-id"]===e["temp-id"]))return!0}),!1},s.prototype._eachAttribute=function(r){var n=this,i=this.model.typedAttributes;Object.keys(i).forEach(function(t){if(n.model.klass.attributeList[t].persist){var e=i[t];r(t,e)}})},s}(),m=function(){function t(){this._data={}}return t.prototype.getItem=function(t){return this._data[t]||null},t.prototype.setItem=function(t,e){this._data[t]=e},t.prototype.removeItem=function(t){delete this._data[t]},t}();try{r=localStorage}catch(t){r=new m}var j=function(){function t(t,e){void 0===e&&(e=r),this._jwtKey=t,this._backend=e}return Object.defineProperty(t.prototype,"backend",{get:function(){return this._backend},enumerable:!0,configurable:!0}),t.prototype.getJWT=function(){return this._backend.getItem(this._jwtKey)||void 0},t.prototype.setJWT=function(t){t?this._backend.setItem(this._jwtKey,t):this._backend.removeItem(this._jwtKey)},t}();function w(t,e){return t===e||t!=t&&e!=e}function O(t,e){for(var r=t.length;r--;)if(w(t[r][0],e))return r;return-1}var k=Array.prototype.splice;function A(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}A.prototype.clear=function(){this.__data__=[],this.size=0},A.prototype.delete=function(t){var e=this.__data__,r=O(e,t);return!(r<0||(r==e.length-1?e.pop():k.call(e,r,1),--this.size,0))},A.prototype.get=function(t){var e=this.__data__,r=O(e,t);return r<0?void 0:e[r][1]},A.prototype.has=function(t){return-1<O(this.__data__,t)},A.prototype.set=function(t,e){var r=this.__data__,n=O(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this};var P="object"==typeof global&&global&&global.Object===Object&&global,$="object"==typeof self&&self&&self.Object===Object&&self,S=P||$||Function("return this")(),E=S.Symbol,R=Object.prototype,x=R.hasOwnProperty,C=R.toString,T=E?E.toStringTag:void 0;var F=Object.prototype.toString;var D="[object Null]",I="[object Undefined]",z=E?E.toStringTag:void 0;function M(t){return null==t?void 0===t?I:D:z&&z in Object(t)?function(t){var e=x.call(t,T),r=t[T];try{var n=!(t[T]=void 0)}catch(t){}var i=C.call(t);return n&&(e?t[T]=r:delete t[T]),i}(t):(e=t,F.call(e));var e}function U(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var L="[object AsyncFunction]",J="[object Function]",B="[object GeneratorFunction]",N="[object Proxy]";function K(t){if(!U(t))return!1;var e=M(t);return e==J||e==B||e==L||e==N}var W,G=S["__core-js_shared__"],H=(W=/[^.]+$/.exec(G&&G.keys&&G.keys.IE_PROTO||""))?"Symbol(src)_1."+W:"";var V=Function.prototype.toString;function Z(t){if(null!=t){try{return V.call(t)}catch(t){}try{return t+""}catch(t){}}return""}var q=/^\[object .+?Constructor\]$/,Q=Function.prototype,Y=Object.prototype,X=Q.toString,tt=Y.hasOwnProperty,et=RegExp("^"+X.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function rt(t){return!(!U(t)||(e=t,H&&H in e))&&(K(t)?et:q).test(Z(t));var e}function nt(t,e){var r,n,i=(n=e,null==(r=t)?void 0:r[n]);return rt(i)?i:void 0}var it=nt(S,"Map"),ot=nt(Object,"create");var st=Object.prototype.hasOwnProperty;var at=Object.prototype.hasOwnProperty;function ut(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function ct(t,e){var r,n,i=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?i["string"==typeof e?"string":"hash"]:i.map}function lt(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ut.prototype.clear=function(){this.__data__=ot?ot(null):{},this.size=0},ut.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},ut.prototype.get=function(t){var e=this.__data__;if(ot){var r=e[t];return"__lodash_hash_undefined__"===r?void 0:r}return st.call(e,t)?e[t]:void 0},ut.prototype.has=function(t){var e=this.__data__;return ot?void 0!==e[t]:at.call(e,t)},ut.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=ot&&void 0===e?"__lodash_hash_undefined__":e,this},lt.prototype.clear=function(){this.size=0,this.__data__={hash:new ut,map:new(it||A),string:new ut}},lt.prototype.delete=function(t){var e=ct(this,t).delete(t);return this.size-=e?1:0,e},lt.prototype.get=function(t){return ct(this,t).get(t)},lt.prototype.has=function(t){return ct(this,t).has(t)},lt.prototype.set=function(t,e){var r=ct(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this};function pt(t){var e=this.__data__=new A(t);this.size=e.size}pt.prototype.clear=function(){this.__data__=new A,this.size=0},pt.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},pt.prototype.get=function(t){return this.__data__.get(t)},pt.prototype.has=function(t){return this.__data__.has(t)},pt.prototype.set=function(t,e){var r=this.__data__;if(r instanceof A){var n=r.__data__;if(!it||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new lt(n)}return r.set(t,e),this.size=r.size,this};var ft=function(){try{var t=nt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();function ht(t,e,r){"__proto__"==e&&ft?ft(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var dt=Object.prototype.hasOwnProperty;function yt(t,e,r){var n=t[e];dt.call(t,e)&&w(n,r)&&(void 0!==r||e in t)||ht(t,e,r)}function bt(t,e,r,n){var i=!r;r||(r={});for(var o=-1,s=e.length;++o<s;){var a=e[o],u=n?n(r[a],t[a],a,r,t):void 0;void 0===u&&(u=t[a]),i?ht(r,a,u):yt(r,a,u)}return r}function vt(t){return null!=t&&"object"==typeof t}function gt(t){return vt(t)&&"[object Arguments]"==M(t)}var _t=Object.prototype,mt=_t.hasOwnProperty,jt=_t.propertyIsEnumerable,wt=gt(function(){return arguments}())?gt:function(t){return vt(t)&&mt.call(t,"callee")&&!jt.call(t,"callee")},Ot=Array.isArray;var kt="object"==typeof t&&t&&!t.nodeType&&t,At=kt&&"object"==typeof module&&module&&!module.nodeType&&module,Pt=At&&At.exports===kt?S.Buffer:void 0,$t=(Pt?Pt.isBuffer:void 0)||function(){return!1},St=9007199254740991,Et=/^(?:0|[1-9]\d*)$/;var Rt=9007199254740991;function xt(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=Rt}var Ct={};Ct["[object Float32Array]"]=Ct["[object Float64Array]"]=Ct["[object Int8Array]"]=Ct["[object Int16Array]"]=Ct["[object Int32Array]"]=Ct["[object Uint8Array]"]=Ct["[object Uint8ClampedArray]"]=Ct["[object Uint16Array]"]=Ct["[object Uint32Array]"]=!0,Ct["[object Arguments]"]=Ct["[object Array]"]=Ct["[object ArrayBuffer]"]=Ct["[object Boolean]"]=Ct["[object DataView]"]=Ct["[object Date]"]=Ct["[object Error]"]=Ct["[object Function]"]=Ct["[object Map]"]=Ct["[object Number]"]=Ct["[object Object]"]=Ct["[object RegExp]"]=Ct["[object Set]"]=Ct["[object String]"]=Ct["[object WeakMap]"]=!1;var Tt,Ft="object"==typeof t&&t&&!t.nodeType&&t,Dt=Ft&&"object"==typeof module&&module&&!module.nodeType&&module,It=Dt&&Dt.exports===Ft&&P.process,zt=function(){try{return It&&It.binding&&It.binding("util")}catch(t){}}(),Mt=zt&&zt.isTypedArray,Ut=Mt?(Tt=Mt,function(t){return Tt(t)}):function(t){return vt(t)&&xt(t.length)&&!!Ct[M(t)]},Lt=Object.prototype.hasOwnProperty;function Jt(t,e){var r,n,i=Ot(t),o=!i&&wt(t),s=!i&&!o&&$t(t),a=!i&&!o&&!s&&Ut(t),u=i||o||s||a,c=u?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],l=c.length;for(var p in t)!e&&!Lt.call(t,p)||u&&("length"==p||s&&("offset"==p||"parent"==p)||a&&("buffer"==p||"byteLength"==p||"byteOffset"==p)||(r=p,(n=null==(n=l)?St:n)&&("number"==typeof r||Et.test(r))&&-1<r&&r%1==0&&r<n))||c.push(p);return c}var Bt=Object.prototype;function Nt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Bt)}function Kt(e,r){return function(t){return e(r(t))}}var Wt=Kt(Object.keys,Object),Gt=Object.prototype.hasOwnProperty;function Ht(t){return null!=t&&xt(t.length)&&!K(t)}function Vt(t){return Ht(t)?Jt(t):function(t){if(!Nt(t))return Wt(t);var e=[];for(var r in Object(t))Gt.call(t,r)&&"constructor"!=r&&e.push(r);return e}(t)}var Zt=Object.prototype.hasOwnProperty;function qt(t){if(!U(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=Nt(t),r=[];for(var n in t)("constructor"!=n||!e&&Zt.call(t,n))&&r.push(n);return r}function Qt(t){return Ht(t)?Jt(t,!0):qt(t)}var Yt="object"==typeof t&&t&&!t.nodeType&&t,Xt=Yt&&"object"==typeof module&&module&&!module.nodeType&&module,te=Xt&&Xt.exports===Yt?S.Buffer:void 0,ee=te?te.allocUnsafe:void 0;function re(){return[]}var ne=Object.prototype.propertyIsEnumerable,ie=Object.getOwnPropertySymbols,oe=ie?function(e){return null==e?[]:(e=Object(e),function(t,e){for(var r=-1,n=null==t?0:t.length,i=0,o=[];++r<n;){var s=t[r];e(s,r,t)&&(o[i++]=s)}return o}(ie(e),function(t){return ne.call(e,t)}))}:re;function se(t,e){for(var r=-1,n=e.length,i=t.length;++r<n;)t[i+r]=e[r];return t}var ae=Kt(Object.getPrototypeOf,Object),ue=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)se(e,oe(t)),t=ae(t);return e}:re;function ce(t,e,r){var n=e(t);return Ot(t)?n:se(n,r(t))}function le(t){return ce(t,Vt,oe)}function pe(t){return ce(t,Qt,ue)}var fe=nt(S,"DataView"),he=nt(S,"Promise"),de=nt(S,"Set"),ye=nt(S,"WeakMap"),be="[object Map]",ve="[object Promise]",ge="[object Set]",_e="[object WeakMap]",me="[object DataView]",je=Z(fe),we=Z(it),Oe=Z(he),ke=Z(de),Ae=Z(ye),Pe=M;(fe&&Pe(new fe(new ArrayBuffer(1)))!=me||it&&Pe(new it)!=be||he&&Pe(he.resolve())!=ve||de&&Pe(new de)!=ge||ye&&Pe(new ye)!=_e)&&(Pe=function(t){var e=M(t),r="[object Object]"==e?t.constructor:void 0,n=r?Z(r):"";if(n)switch(n){case je:return me;case we:return be;case Oe:return ve;case ke:return ge;case Ae:return _e}return e});var $e=Pe,Se=Object.prototype.hasOwnProperty;var Ee=S.Uint8Array;function Re(t){var e=new t.constructor(t.byteLength);return new Ee(e).set(new Ee(t)),e}function xe(t,e){return t.set(e[0],e[1]),t}function Ce(t,e,r,n){var i=-1,o=null==t?0:t.length;for(n&&o&&(r=t[++i]);++i<o;)r=e(r,t[i],i,t);return r}function Te(t){var r=-1,n=Array(t.size);return t.forEach(function(t,e){n[++r]=[e,t]}),n}var Fe=1;var De=/\w*$/;function Ie(t,e){return t.add(e),t}function ze(t){var e=-1,r=Array(t.size);return t.forEach(function(t){r[++e]=t}),r}var Me=1;var Ue=E?E.prototype:void 0,Le=Ue?Ue.valueOf:void 0;var Je="[object Boolean]",Be="[object Date]",Ne="[object Map]",Ke="[object Number]",We="[object RegExp]",Ge="[object Set]",He="[object String]",Ve="[object Symbol]",Ze="[object ArrayBuffer]",qe="[object DataView]",Qe="[object Float32Array]",Ye="[object Float64Array]",Xe="[object Int8Array]",tr="[object Int16Array]",er="[object Int32Array]",rr="[object Uint8Array]",nr="[object Uint8ClampedArray]",ir="[object Uint16Array]",or="[object Uint32Array]";function sr(t,e,r,n){var i,o,s,a,u,c,l,p,f,h,d,y=t.constructor;switch(e){case Ze:return Re(t);case Je:case Be:return new y(+t);case qe:return h=t,d=n?Re(h.buffer):h.buffer,new h.constructor(d,h.byteOffset,h.byteLength);case Qe:case Ye:case Xe:case tr:case er:case rr:case nr:case ir:case or:return p=t,f=n?Re(p.buffer):p.buffer,new p.constructor(f,p.byteOffset,p.length);case Ne:return c=t,l=r,Ce(n?l(Te(c),Fe):Te(c),xe,new c.constructor);case Ke:case He:return new y(t);case We:return(u=new(a=t).constructor(a.source,De.exec(a))).lastIndex=a.lastIndex,u;case Ge:return o=t,s=r,Ce(n?s(ze(o),Me):ze(o),Ie,new o.constructor);case Ve:return i=t,Le?Object(Le.call(i)):{}}}var ar=Object.create,ur=function(){function r(){}return function(t){if(!U(t))return{};if(ar)return ar(t);r.prototype=t;var e=new r;return r.prototype=void 0,e}}();var cr=1,lr=2,pr=4,fr="[object Arguments]",hr="[object Function]",dr="[object GeneratorFunction]",yr="[object Object]",br={};function vr(r,n,i,t,e,o){var s,a=n&cr,u=n&lr,c=n&pr;if(i&&(s=e?i(r,t,e,o):i(r)),void 0!==s)return s;if(!U(r))return r;var l,p,f,h,d,y,b,v,g,_,m,j,w=Ot(r);if(w){if(m=(_=r).length,j=_.constructor(m),m&&"string"==typeof _[0]&&Se.call(_,"index")&&(j.index=_.index,j.input=_.input),s=j,!a)return function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(r,s)}else{var O=$e(r),k=O==hr||O==dr;if($t(r))return function(t,e){if(e)return t.slice();var r=t.length,n=ee?ee(r):new t.constructor(r);return t.copy(n),n}(r,a);if(O==yr||O==fr||k&&!e){if(s=u||k?{}:"function"!=typeof(g=r).constructor||Nt(g)?{}:ur(ae(g)),!a)return u?(v=d=r,y=(b=s)&&bt(v,Qt(v),b),bt(d,ue(d),y)):(h=l=r,p=(f=s)&&bt(h,Vt(h),f),bt(l,oe(l),p))}else{if(!br[O])return e?r:{};s=sr(r,O,vr,a)}}o||(o=new pt);var A=o.get(r);if(A)return A;o.set(r,s);var P=c?u?pe:le:u?keysIn:Vt,$=w?void 0:P(r);return function(t,e){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==e(t[r],r,t););}($||r,function(t,e){$&&(t=r[e=t]),yt(s,e,vr(t,n,i,e,r,o))}),s}br[fr]=br["[object Array]"]=br["[object ArrayBuffer]"]=br["[object DataView]"]=br["[object Boolean]"]=br["[object Date]"]=br["[object Float32Array]"]=br["[object Float64Array]"]=br["[object Int8Array]"]=br["[object Int16Array]"]=br["[object Int32Array]"]=br["[object Map]"]=br["[object Number]"]=br[yr]=br["[object RegExp]"]=br["[object Set]"]=br["[object String]"]=br["[object Symbol]"]=br["[object Uint8Array]"]=br["[object Uint8ClampedArray]"]=br["[object Uint16Array]"]=br["[object Uint32Array]"]=!0,br["[object Error]"]=br[hr]=br["[object WeakMap]"]=!1;var gr=1,_r=4;function mr(t){return vr(t,gr|_r)}"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;var jr,wr=(function(t,e){var r;t.exports=(r={},(r=function(){this.listeners={}}).prototype={addEventListener:function(t,e,r){for(var n=[],i=arguments.length,o=0;o<i;o++)n.push(arguments[o]);n=3<n.length?n.splice(3,n.length-1):[],void 0!==this.listeners[t]?this.listeners[t].push({scope:r,callback:e,args:n}):this.listeners[t]=[{scope:r,callback:e,args:n}]},removeEventListener:function(t,e,r){if(void 0!==this.listeners[t]){for(var n=this.listeners[t].length,i=[],o=0;o<n;o++){var s=this.listeners[t][o];s.scope==r&&s.callback==e||i.push(s)}this.listeners[t]=i}},hasEventListener:function(t,e,r){if(void 0!==this.listeners[t]){var n=this.listeners[t].length;if(void 0===e&&void 0===r)return 0<n;for(var i=0;i<n;i++){var o=this.listeners[t][i];if((!r||o.scope==r)&&o.callback==e)return!0}}return!1},dispatch:function(t,e){for(var r={type:t,target:e},n=[],i=arguments.length,o=0;o<i;o++)n.push(arguments[o]);if(n=2<n.length?n.splice(2,n.length-1):[],n=[r].concat(n),void 0!==this.listeners[t]){var s=this.listeners[t].slice(),a=s.length;for(o=0;o<a;o++){var u=s[o];if(u&&u.callback){var c=n.concat(u.args);u.callback.apply(u.scope,c)}}}},getEvents:function(){var t="";for(var e in this.listeners)for(var r=this.listeners[e].length,n=0;n<r;n++){var i=this.listeners[e][n];t+=i.scope&&i.scope.className?i.scope.className:"anonymous",t+=" listen for '"+e+"'\n"}return t}},new r)}(jr={exports:{}},jr.exports),jr.exports),Or=Object.freeze({default:wr,__moduleExports:wr}),kr=function(){function t(){this.data={}}return Object.defineProperty(t.prototype,"count",{get:function(){return Object.keys(this.data).length},enumerable:!0,configurable:!0}),t.prototype.find=function(t,e){return void 0===e&&(e=null),e||(e=t.storeKey),this.data[e]},t.prototype.findAll=function(t){var r=this,n=[];return t.forEach(function(t){var e=r.find(t);e&&n.push(e)}),n},t.prototype.create=function(t,e){t.storeKey=e,t.stale=!1,this.data[e]=mr(t.attributes)},t.prototype.updateOrCreate=function(t){if(t.storeKey)this.create(t,t.storeKey);else{var e=this.keyFor(t);this.create(t,e)}Or.dispatch(t.storeKey,{},this.data[t.storeKey])},t.prototype.destroy=function(t){t.stale=!0,delete this.data[t.storeKey]},t.prototype.keyFor=function(t){return t.klass.jsonapiType+"-"+t.id},t}(),Ar=function(){function t(t,e){this._deserialized=[],this._resources=[],this.registry=t,this.payload=e,this.addResources(e.data),this.addResources(e.included)}return t.prototype.addResources=function(t){if(t)if(Array.isArray(t))for(var e=0,r=t;e<r.length;e++){var n=r[e];this._resources.push(n)}else this._resources.push(t)},t.prototype.instanceFor=function(t){var e=this.registry.get(t);if(!e)throw new Error('Unknown type "'+t+'"');return new e},t.prototype.relationshipInstanceFor=function(e,t){var r=t.find(function(t){return!(t.klass.jsonapiType!==e.type||!(t.id&&e.id&&t.id===e.id||t.temp_id&&e["temp-id"]&&t.temp_id===e["temp-id"]))});return r||(r=this.instanceFor(e.type)),r},t.prototype.lookupAssociated=function(t,e){return t.find(function(t){return!(t.klass.jsonapiType!==e.klass.jsonapiType||!(t.temp_id&&e.temp_id&&t.temp_id===e.temp_id||t.id&&e.id&&t.id===e.id))})},t.prototype.pushRelation=function(t,e,r){var n=t,i=n[e];this.lookupAssociated(i,r)||n[e].push(r)},t.prototype.deserialize=function(t){var e=this.instanceFor(t.type);return this.deserializeInstance(e,t,{})},t.prototype.deserializeInstance=function(t,e,r){void 0===r&&(r={});var n=this.alreadyDeserialized(e);return n||(t.id=e.id,t.temp_id=e["temp-id"],t.assignAttributes(e.attributes),t.setMeta(e.meta),this._deserialized.push(t),this._processRelationships(t,e.relationships||{},r),this._removeDeletions(t,r),t.isPersisted=!0,t.reset(),t)},t.prototype._removeDeletions=function(i,o){var s=this;Object.keys(o).forEach(function(r){var n=i,t=n[r];if(t)if(Array.isArray(t))t.forEach(function(t,e){t.isMarkedForDestruction?n.klass.store.destroy(t):t.isMarkedForDisassociation?n[r].splice(e,1):s._removeDeletions(t,o[r]||{})});else{var e=t;e.isMarkedForDestruction?n.klass.store.destroy(e):e.isMarkedForDisassociation?n[r]=null:s._removeDeletions(e,o[r]||{})}})},t.prototype._processRelationships=function(f,t,h){var d=this;this._iterateValidRelationships(f,t,function(t,e){var r=h[t],n=f;if(Array.isArray(e))for(var i=0,o=e;i<o.length;i++){var s=o[i],a=d.findResource(s),u=n[t],c=d.relationshipInstanceFor(a,u);c=d.deserializeInstance(c,a,r),d.pushRelation(f,t,c)}else{a=d.findResource(e);var l=n[t],p=l||d.instanceFor(a.type);p=d.deserializeInstance(p,a,r),l||(n[t]=p)}})},t.prototype._iterateValidRelationships=function(t,e,r){for(var n in e)if(e.hasOwnProperty(n)){var i=t.klass.deserializeKey(n);if(t.klass.attributeList[i]){var o=e[n].data;if(!o)continue;r(i,o)}}},t.prototype.alreadyDeserialized=function(e){return this._deserialized.find(function(t){return!(t.klass.jsonapiType!==e.type||!(t.id&&e.id&&t.id===e.id||t.temp_id&&e.temp_id&&t.temp_id===e["temp-id"]))})},t.prototype.findResource=function(e){return this._resources.find(function(t){return!(t.type!==e.type||!(t.id&&e.id&&t.id===e.id||t["temp-id"]&&e["temp-id"]&&t["temp-id"]===e["temp-id"]))})||e},t}(),Pr=function(){function t(t){this.model=t}return t.prototype.checkRelation=function(t,e){var r=!1;e.isPersisted&&((this.model._originalRelationships[t]||[]).find(function(t){return JSON.stringify(t)===JSON.stringify(e.resourceIdentifier)})||(r=!0));return r},t.prototype.check=function(t){void 0===t&&(t={});var e=new b(t).toScopeObject();return this._hasDirtyAttributes()||this._hasDirtyRelationships(e)||this.model.isMarkedForDestruction||this.model.isMarkedForDisassociation||this._isUnpersisted()},t.prototype.dirtyAttributes=function(){for(var t={},e=0,r=Object.keys(this.model.attributes);e<r.length;e++){var n=r[e],i=this.model._originalAttributes[n],o=this.model.attributes[n];this.model.isPersisted?i!==o&&(t[n]=[i,o]):t[n]=[null,o]}return t},t.prototype._isUnpersisted=function(){return!this.model.isPersisted&&JSON.stringify(this.model.attributes)!==JSON.stringify({})},t.prototype._hasDirtyAttributes=function(){var t=this.model._originalAttributes,e=this.model.attributes;return JSON.stringify(t)!==JSON.stringify(e)},t.prototype._hasDirtyRelationships=function(t){var n=this,i=!1;return this._eachRelatedObject(t,function(t,e,r){e.isDirty(r)&&(i=!0),n.checkRelation(t,e)&&(i=!0)}),i},t.prototype._eachRelatedObject=function(n,i){var o=this;Object.keys(n).forEach(function(e){var r=n[e],t=o.model[e];Array.isArray(t)||(t=[t]),t.forEach(function(t){t&&i(e,t,r)})})},t}(),$r=function(t,e){var r=[];for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];null!=i&&""!==i&&(e&&(n=e+"["+n+"]"),Array.isArray(i)?0<i.length&&r.push(n+"="+i.join(",")):"object"==typeof i?r.push($r(i,n)):r.push(n+"="+i))}return(r=r.filter(function(t){return!!t})).join("&")},Sr=function(){function t(t,e){void 0===e&&(e={data:[]}),this._collection=t,this._raw_json=e}return Object.defineProperty(t.prototype,"raw",{get:function(){return this._raw_json},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._collection},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!0,configurable:!0}),t}(),Er=function(){function t(t,e){this._record=t,this._raw_json=e}return Object.defineProperty(t.prototype,"raw",{get:function(){return this._raw_json},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._record},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!0,configurable:!0}),t}(),Rr=function(){function t(t){this._raw_json=t}return Object.defineProperty(t.prototype,"raw",{get:function(){return this._raw_json},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"meta",{get:function(){return this.raw.meta||{}},enumerable:!0,configurable:!0}),t}(),xr=function(){function t(t){this._associations={},this._pagination={},this._filter={},this._sort={},this._fields={},this._extra_fields={},this._include={},this._stats={},this._extraParams={},this.model=t}return t.prototype.all=function(){return a(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,this._fetch(this.model.url())];case 1:return e=t.sent(),[2,this._buildCollectionResult(e)]}})})},t.prototype.find=function(r){return a(this,void 0,void 0,function(){var e;return c(this,function(t){switch(t.label){case 0:return[4,this._fetch(this.model.url(r))];case 1:return e=t.sent(),[2,this._buildRecordResult(e)]}})})},t.prototype.first=function(){return a(this,void 0,void 0,function(){var e,r;return c(this,function(t){switch(t.label){case 0:return[4,(e=this.per(1))._fetch(e.model.url())];case 1:return r=t.sent(),[2,this._buildRecordResult(r)]}})})},t.prototype.merge=function(e){var r=this.copy();return Object.keys(e).forEach(function(t){r._associations[t]=e[t]}),r},t.prototype.page=function(t){var e=this.copy();return e._pagination.number=t,e},t.prototype.per=function(t){var e=this.copy();return e._pagination.size=t,e},t.prototype.where=function(t){var e=this.copy();for(var r in t)t.hasOwnProperty(r)&&(e._filter[r]=t[r]);return e},t.prototype.extraParams=function(t){var e=this.copy();for(var r in t)t.hasOwnProperty(r)&&(e._extraParams[r]=t[r]);return e},t.prototype.stats=function(t){var e=this.copy();for(var r in t)t.hasOwnProperty(r)&&(e._stats[r]=t[r]);return e},t.prototype.order=function(t){var e=this.copy();if("object"==typeof t)for(var r in t)t.hasOwnProperty(r)&&(e._sort[r]=t[r]);else e._sort[t]="asc";return e},t.prototype.select=function(t){var e=this.copy();if(Array.isArray(t)){var r=t,n=this.model.jsonapiType;e._fields[n]=r}else for(var i in t)t.hasOwnProperty(i)&&(e._fields[i]=t[i]);return e},t.prototype.selectExtra=function(t){var e=this.copy();if(Array.isArray(t)){var r=t,n=this.model.jsonapiType;e._extra_fields[n]=r}else for(var i in t)t.hasOwnProperty(i)&&(e._extra_fields[i]=t[i]);return e},t.prototype.includes=function(t){var e=this.copy(),r=new b(t).toScopeObject();for(var n in r)r.hasOwnProperty(n)&&(e._include[n]=r[n]);return e},t.prototype.scope=function(){return this},t.prototype.asQueryParams=function(){var e=this,r={page:this._pagination,filter:this._filter,sort:this._sortParam(this._sort)||[],fields:this._fields,extra_fields:this._extra_fields,stats:this._stats,include:new b(this._include).toString()};return this._mergeAssociationQueryParams(r,this._associations),Object.keys(this._extraParams).forEach(function(t){r[t]=e._extraParams[t]}),r},t.prototype.toQueryParams=function(){var t=$r(this.asQueryParams());if(""!==t)return t},t.prototype.copy=function(){return mr(this)},t.prototype._mergeAssociationQueryParams=function(n,e){var i=this,t=function(r){if(e.hasOwnProperty(r)){var t=e[r].asQueryParams();n.page[r]=t.page,n.filter[r]=t.filter,n.stats[r]=t.stats,Object.assign(n.fields,t.fields),Object.assign(n.extra_fields,t.extra_fields),t.sort.forEach(function(t){var e=i._transformAssociationSortParam(r,t);n.sort.push(e)})}};for(var r in e)t(r)},t.prototype._transformAssociationSortParam=function(t,e){return-1!==e.indexOf("-")&&(e=e.replace("-",""),t="-"+t),t+"."+e},t.prototype._sortParam=function(t){if(t&&0<Object.keys(t).length){var e=[];for(var r in t)t.hasOwnProperty(r)&&("asc"!==t[r]&&(r="-"+r),e.push(r));return e}},t.prototype._fetch=function(o){return a(this,void 0,void 0,function(){var e,r,n,i;return c(this,function(t){switch(t.label){case 0:return(e=this.toQueryParams())&&(o=o+"?"+e),r=new h(this.model.middlewareStack,this.model.logger),n=this.model.fetchOptions(),[4,r.get(o,n)];case 1:return i=t.sent(),u(this.model,i),[2,i.jsonPayload]}})})},t.prototype._buildRecordResult=function(t){var e,r;if(t.data instanceof Array){if(!(r=t.data[0]))return new Rr(t)}else r=t.data;return e=this.model.fromJsonapi(r,t),new Er(e,t)},t.prototype._buildCollectionResult=function(e){var r=this,n=[];return e.data.forEach(function(t){n.push(r.model.fromJsonapi(t,e))}),new Sr(n,e)},t}(),Cr=function(){function t(t){this._typeMap={},this._baseClass=t}return t.prototype.register=function(t,e){if(this._typeMap[t])throw new Error('Type "'+t+'" already registered on base class '+this._baseClass);this._typeMap[t]=e},t.prototype.get=function(t){return this._typeMap[t]},t}(),Tr=Object.prototype.toString;var Fr=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Dr=function(){function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}}();function Ir(t){return t.split("").map(function(t){return"(?:"+t.toUpperCase()+"|"+t.toLowerCase()+")"}).join("")}function zr(t,e){for(var r=t.length-1;0<=r;r--)t[r]===e&&Array.prototype.splice.call(t,r,1)}var Mr={},Ur=function(){function e(){Fr(this,e),this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[],this.acronyms={},this.acronymRegex=/(?=a)b/}return Dr(e,null,[{key:"getInstance",value:function(t){return Mr[t]=Mr[t]||new e,Mr[t]}}]),Dr(e,[{key:"acronym",value:function(t){this.acronyms[t.toLowerCase()]=t;var e,r,n=[];for(var i in this.acronyms)e=this.acronyms,r=i,Object.prototype.hasOwnProperty.call(e,r)&&n.push(this.acronyms[i]);this.acronymRegex=new RegExp(n.join("|"))}},{key:"plural",value:function(t,e){"string"==typeof t&&zr(this.uncountables,t),zr(this.uncountables,e),this.plurals.unshift([t,e])}},{key:"singular",value:function(t,e){"string"==typeof t&&zr(this.uncountables,t),zr(this.uncountables,e),this.singulars.unshift([t,e])}},{key:"irregular",value:function(t,e){zr(this.uncountables,t),zr(this.uncountables,e);var r=t[0],n=t.substr(1),i=e[0],o=e.substr(1);if(r.toUpperCase()===i.toUpperCase())this.plural(new RegExp("("+r+")"+n+"$","i"),"$1"+o),this.plural(new RegExp("("+i+")"+o+"$","i"),"$1"+o),this.singular(new RegExp("("+r+")"+n+"$","i"),"$1"+n),this.singular(new RegExp("("+i+")"+o+"$","i"),"$1"+n);else{var s=Ir(n),a=Ir(o);this.plural(new RegExp(r.toUpperCase()+s+"$"),i.toUpperCase()+o),this.plural(new RegExp(r.toLowerCase()+s+"$"),i.toLowerCase()+o),this.plural(new RegExp(i.toUpperCase()+a+"$"),i.toUpperCase()+o),this.plural(new RegExp(i.toLowerCase()+a+"$"),i.toLowerCase()+o),this.singular(new RegExp(r.toUpperCase()+s+"$"),r.toUpperCase()+n),this.singular(new RegExp(r.toLowerCase()+s+"$"),r.toLowerCase()+n),this.singular(new RegExp(i.toUpperCase()+a+"$"),r.toUpperCase()+n),this.singular(new RegExp(i.toLowerCase()+a+"$"),r.toLowerCase()+n)}}},{key:"uncountable",value:function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];this.uncountables=this.uncountables.concat(e)}},{key:"human",value:function(t,e){this.humans.unshift([t,e])}},{key:"clear",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"all";"all"===t?(this.plurals=[],this.singulars=[],this.uncountables=[],this.humans=[]):this[t]=[]}}]),e}();var Lr={en:function(t){t.plural(/$/,"s"),t.plural(/s$/i,"s"),t.plural(/^(ax|test)is$/i,"$1es"),t.plural(/(octop|vir)us$/i,"$1i"),t.plural(/(octop|vir)i$/i,"$1i"),t.plural(/(alias|status)$/i,"$1es"),t.plural(/(bu)s$/i,"$1ses"),t.plural(/(buffal|tomat)o$/i,"$1oes"),t.plural(/([ti])um$/i,"$1a"),t.plural(/([ti])a$/i,"$1a"),t.plural(/sis$/i,"ses"),t.plural(/(?:([^f])fe|([lr])f)$/i,"$1$2ves"),t.plural(/(hive)$/i,"$1s"),t.plural(/([^aeiouy]|qu)y$/i,"$1ies"),t.plural(/(x|ch|ss|sh)$/i,"$1es"),t.plural(/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"),t.plural(/^(m|l)ouse$/i,"$1ice"),t.plural(/^(m|l)ice$/i,"$1ice"),t.plural(/^(ox)$/i,"$1en"),t.plural(/^(oxen)$/i,"$1"),t.plural(/(quiz)$/i,"$1zes"),t.singular(/s$/i,""),t.singular(/(ss)$/i,"$1"),t.singular(/(n)ews$/i,"$1ews"),t.singular(/([ti])a$/i,"$1um"),t.singular(/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(sis|ses)$/i,"$1sis"),t.singular(/(^analy)(sis|ses)$/i,"$1sis"),t.singular(/([^f])ves$/i,"$1fe"),t.singular(/(hive)s$/i,"$1"),t.singular(/(tive)s$/i,"$1"),t.singular(/([lr])ves$/i,"$1f"),t.singular(/([^aeiouy]|qu)ies$/i,"$1y"),t.singular(/(s)eries$/i,"$1eries"),t.singular(/(m)ovies$/i,"$1ovie"),t.singular(/(x|ch|ss|sh)es$/i,"$1"),t.singular(/^(m|l)ice$/i,"$1ouse"),t.singular(/(bus)(es)?$/i,"$1"),t.singular(/(o)es$/i,"$1"),t.singular(/(shoe)s$/i,"$1"),t.singular(/(cris|test)(is|es)$/i,"$1is"),t.singular(/^(a)x[ie]s$/i,"$1xis"),t.singular(/(octop|vir)(us|i)$/i,"$1us"),t.singular(/(alias|status)(es)?$/i,"$1"),t.singular(/^(ox)en/i,"$1"),t.singular(/(vert|ind)ices$/i,"$1ex"),t.singular(/(matr)ices$/i,"$1ix"),t.singular(/(quiz)zes$/i,"$1"),t.singular(/(database)s$/i,"$1"),t.irregular("person","people"),t.irregular("man","men"),t.irregular("child","children"),t.irregular("sex","sexes"),t.irregular("move","moves"),t.irregular("zombie","zombies"),t.uncountable("equipment","information","rice","money","species","series","fish","sheep","jeans","police")}};function Jr(t,e){var r;if(r=t,"[object Function]"===Tr.call(r)&&(e=t,t=null),t=t||"en",!e)return Ur.getInstance(t);e(Ur.getInstance(t))}for(var Br in Lr)Jr(Br,Lr[Br]);function Nr(t){return function(t,e){var r,n,i,o=""+t;if(0===o.length)return o;var s=o.toLowerCase().match(/\b\w+$/);if(s&&-1<Jr().uncountables.indexOf(s[0]))return o;for(var a=0,u=e.length;a<u;a++)if(n=(r=e[a])[0],i=r[1],o.match(n)){o=o.replace(n,i);break}return o}(t,Jr(1<arguments.length&&void 0!==arguments[1]?arguments[1]:"en").plurals)}function Kr(t){var e=null==t?"":String(t);return e.charAt(0).toUpperCase()+e.slice(1)}function Wr(t,e){null==e&&(e=!0);var r=""+t;return r=(r=e?r.replace(/^[a-z\d]*/,function(t){return Jr().acronyms[t]||Kr(t)}):r.replace(new RegExp("^(?:"+Jr().acronymRegex.source+"(?=\\b|[A-Z_])|\\w)"),function(t){return t.toLowerCase()})).replace(/(?:_|(\/))([a-z\d]*)/gi,function(t,e,r,n,i){return e||(e=""),""+e+(Jr().acronyms[r]||Kr(r))})}function Gr(t){var e=""+t;return(e=(e=(e=(e=e.replace(new RegExp("(?:([A-Za-z\\d])|^)("+Jr().acronymRegex.source+")(?=\\b|[^a-z])","g"),function(t,e,r){return(e||"")+(e?"_":"")+r.toLowerCase()})).replace(/([A-Z\d]+)([A-Z][a-z])/g,"$1_$2")).replace(/([a-z\d])([A-Z])/g,"$1_$2")).replace(/-/g,"_")).toLowerCase()}function Hr(t){return t.replace(/_/g,"-")}var Vr,Zr,qr={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","×":"x","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","Þ":"Th","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","þ":"th","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","Ď":"D","ď":"d","Đ":"D","đ":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","ĝ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ħ":"H","ħ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","ı":"i","Ĳ":"IJ","ĳ":"ij","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L","ŀ":"l","Ł":"L","ł":"l","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"'n","Ŋ":"NG","ŋ":"ng","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Œ":"OE","œ":"oe","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ŧ":"T","ŧ":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z"},Qr={};!function(){function e(){for(var t in Fr(this,e),this.approximations={},qr)this.approximate(t,qr[t])}Dr(e,null,[{key:"getInstance",value:function(t){return Qr[t]=Qr[t]||new e,Qr[t]}}]),Dr(e,[{key:"approximate",value:function(t,e){this.approximations[t]=e}},{key:"transliterate",value:function(t,e){var r=this;return t.replace(/[^\u0000-\u007f]/g,function(t){return r.approximations[t]||e||"?"})}}])}();(Zr=Vr||(Vr={}))[Zr.debug=1]="debug",Zr[Zr.info=2]="info",Zr[Zr.warn=3]="warn",Zr[Zr.error=4]="error";var Yr={debug:1,info:2,warn:3,error:4},Xr=new(function(){function t(t){void 0===t&&(t="warn"),this._level=Vr.info,"number"==typeof t?this._level=t:this.level=t}return t.prototype.debug=function(t){this._level<=Vr.debug&&console.info(t)},t.prototype.info=function(t){this._level<=Vr.info&&console.info(t)},t.prototype.warn=function(t){this._level<=Vr.warn&&console.warn(t)},t.prototype.error=function(t){this._level<=Vr.warn&&console.error(t)},Object.defineProperty(t.prototype,"level",{get:function(){var t;for(t in Vr){if(Vr.hasOwnProperty(t))if(Vr[t]===this._level)return t}throw new Error("Invalid log level: "+this._level)},set:function(t){var e=Vr[t];if(!e)throw new Error("Log level must be one of "+Object.keys(Yr).join(", "));this._level=e},enumerable:!0,configurable:!0}),t}()),tn=function(){function t(t,e){void 0===t&&(t=[]),void 0===e&&(e=[]),this._beforeFilters=[],this._afterFilters=[],this._beforeFilters=t,this._afterFilters=e}return Object.defineProperty(t.prototype,"beforeFilters",{get:function(){return this._beforeFilters},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"afterFilters",{get:function(){return this._afterFilters},enumerable:!0,configurable:!0}),t.prototype.beforeFetch=function(e,r){this._beforeFilters.forEach(function(t){t(e,r)})},t.prototype.afterFetch=function(e,r){this._afterFilters.forEach(function(t){t(e,r)})},t}(),en=function(t,e){Object.defineProperty(t,e,{get:function(){},set:function(t){Object.defineProperty(this,e,{value:t,writable:!0,configurable:!0,enumerable:!1})},configurable:!0,enumerable:!1})},rn=function(t,e){var r;for(r in(e=i({},e)).credentialStorageBackend&&(t.credentialStorageBackend=e.credentialStorageBackend,delete e.jwtStorage),e.jwtStorage&&(t.jwtStorage=e.jwtStorage,delete e.jwtStorage),e.jwt&&(t.setJWT(e.jwt),delete e.jwt),e)e.hasOwnProperty(r)&&(t[r]=e[r]);void 0===t.isBaseClass?t.setAsBase():!0===t.isBaseClass&&(t.isBaseClass=!1)},nn=function(){function i(t){this.stale=!1,this.storeKey="",this.relationships={},this._persisted=!1,this._markedForDestruction=!1,this._markedForDisassociation=!1,this._originalRelationships={},this._errors={},this._initializeAttributes(),this.assignAttributes(t),this._originalAttributes=mr(this._attributes),this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(this.relationships))}return Object.defineProperty(i,"credentialStorage",{get:function(){return this._credentialStorage},enumerable:!0,configurable:!0}),Object.defineProperty(i,"jwtStorage",{get:function(){return this._jwtStorage},set:function(t){t!==this._jwtStorage&&(this._jwtStorage=t,this.credentialStorageBackend=this._credentialStorageBackend)},enumerable:!0,configurable:!0}),Object.defineProperty(i,"credentialStorageBackend",{get:function(){return this._credentialStorageBackend},set:function(t){this._credentialStorageBackend=t,this._credentialStorage=new j(this.jwtStorage||"jwt",this._credentialStorageBackend)},enumerable:!0,configurable:!0}),i.initializeCredentialStorage=function(){this.jwtStorage&&"undefined"!=typeof localStorage?this.credentialStorageBackend=localStorage:this.credentialStorageBackend=new m},i.fromJsonapi=function(t,e){return r=this.typeRegistry,n=t,new Ar(r,e).deserialize(n);var r,n},i.inherited=function(t){t.parentClass=this,((t.currentClass=t).prototype.klass=t).attributeList=mr(t.attributeList)},i.setAsBase=function(){this.isBaseClass=!0,this.jsonapiType=void 0,this.typeRegistry||(this.typeRegistry=new Cr(this)),this.middlewareStack||(this._middlewareStack=new tn),this._IDMap||(this._IDMap=new kr)},i.isSubclassOf=function(t){for(var e=this.currentClass;e;){if(e===t)return!0;e=e.parentClass}return!1},Object.defineProperty(i,"baseClass",{get:function(){for(var t=this.currentClass;t;){if(t.isBaseClass)return t;t=t.parentClass}},enumerable:!0,configurable:!0}),Object.defineProperty(i,"store",{get:function(){if(void 0===this.baseClass)throw new Error("No base class for "+this.name);return this.baseClass._IDMap},enumerable:!0,configurable:!0}),Object.defineProperty(i,"typeRegistry",{get:function(){if(void 0===this.baseClass)throw new Error("No base class for "+this.name);return this.baseClass._typeRegistry},set:function(t){if(!this.isBaseClass)throw new Error("Cannot set a registry on a non-base class");this._typeRegistry=t},enumerable:!0,configurable:!0}),i.registerType=function(){if(this.jsonapiType){var t=this.typeRegistry.get(this.jsonapiType);t&&this.isSubclassOf(t)||this.typeRegistry.register(this.jsonapiType,this)}},i.extend=function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(this);this.inherited(e);var r={};if(t.attrs)for(var n in t.attrs)if(t.attrs.hasOwnProperty(n)){var i=t.attrs[n];i.name||(i.name=n),i.owner=e,r[n]=i}if(e.attributeList=Object.assign({},e.attributeList,r),rn(e,t.static||{}),e.registerType(),t.methods)for(var o in t.methods)t.methods.hasOwnProperty(o)&&(e.prototype[o]=t.methods[o]);return e},i.prototype._initializeAttributes=function(){this._attributes={},this._copyPrototypeDescriptors()},i.prototype._copyPrototypeDescriptors=function(){var r=this,t=this.klass.attributeList;for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];Object.defineProperty(this,e,n.descriptor())}["errors","isPersisted","isMarkedForDestruction","isMarkedForDisassociation"].forEach(function(t){var e=Object.getOwnPropertyDescriptor(i.prototype,t);e&&Object.defineProperty(r,t,e)})},i.prototype.isType=function(t){return this.klass.jsonapiType===t},Object.defineProperty(i.prototype,"isPersisted",{get:function(){return this._persisted},set:function(t){(this._persisted=t)&&this.reset()},enumerable:!0,configurable:!0}),i.prototype.onStoreChange=function(){var o=this;return this._onStoreChange||(this._onStoreChange=function(t,n){var i={};Object.keys(n).forEach(function(t){var e=o,r=o.changes();e[t]===n[t]||r[t]||(i[t]=[e[t],n[t]],e[t]=n[t],e._originalAttributes[t]=n[t])}),0<Object.keys(i).length&&void 0!==o.afterSync&&o.afterSync(i)}),this._onStoreChange},i.prototype.unlisten=function(){var r=this;this.klass.sync&&(this.storeKey&&Or.removeEventListener(this.storeKey,this.onStoreChange()),Object.keys(this.relationships).forEach(function(t){var e=r.relationships[t];e&&(Array.isArray(e)?e.forEach(function(t){return t.unlisten()}):e.unlisten())}))},i.prototype.listen=function(){this.klass.sync&&(this._onStoreChange||Or.addEventListener(this.storeKey,this.onStoreChange()))},i.prototype.reset=function(){this.klass.sync&&(this.klass.store.updateOrCreate(this),this.listen()),this._originalAttributes=mr(this._attributes),this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(this.relationships))},Object.defineProperty(i.prototype,"isMarkedForDestruction",{get:function(){return this._markedForDestruction},set:function(t){this._markedForDestruction=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isMarkedForDisassociation",{get:function(){return this._markedForDisassociation},set:function(t){this._markedForDisassociation=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"attributes",{get:function(){return this._attributes},set:function(t){this._attributes={},this.assignAttributes(t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"stored",{get:function(){return this.klass.store.find(this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"typedAttributes",{get:function(){return this._attributes},enumerable:!0,configurable:!0}),i.prototype.relationship=function(t){return this.relationships[t]},i.prototype.assignAttributes=function(t){if(t)for(var e in t)if(t.hasOwnProperty(e)){var r;if(r=this.klass.deserializeKey(e),"id"===e||this.klass.attributeList[r])this[r]=t[e];else if(this.klass.strictAttributes)throw new Error("Unknown attribute: "+e)}},i.prototype.setMeta=function(t){this.__meta__=t},i.prototype.relationshipResourceIdentifiers=function(t){return r=this,n={},t.forEach(function(e){var t=r.relationship(e);t&&(Array.isArray(t)||(t=[t]),t.forEach(function(t){t.isPersisted&&(n[e]||(n[e]=[]),n[e].push(t.resourceIdentifier))}))}),n;var r,n},i.prototype.fromJsonapi=function(t,e,r){return void 0===r&&(r={}),i=t,o=e,void 0===(s=r)&&(s={}),new Ar((n=this).klass.typeRegistry,o).deserializeInstance(n,i,s);var n,i,o,s},Object.defineProperty(i.prototype,"resourceIdentifier",{get:function(){if(void 0===this.klass.jsonapiType)throw new Error("Cannot build resource identifier for class. No JSONAPI Type specified.");return{id:this.id,type:this.klass.jsonapiType}},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"errors",{get:function(){return this._errors},set:function(t){this._errors=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"hasError",{get:function(){return 1<Object.keys(this._errors).length},enumerable:!0,configurable:!0}),i.prototype.clearErrors=function(){this.errors={}},i.prototype.isDirty=function(t){return new Pr(this).check(t)},i.prototype.changes=function(){return new Pr(this).dirtyAttributes()},i.prototype.hasDirtyRelation=function(t,e){return new Pr(this).checkRelation(t,e)},i.prototype.dup=function(){var t=Object.assign({},this.attributes,this.relationships),e=new this.klass(t);return e.id=this.id,e.isPersisted=this.isPersisted,e.isMarkedForDestruction=this.isMarkedForDestruction,e.isMarkedForDisassociation=this.isMarkedForDisassociation,e.errors=Object.assign({},this.errors),e},i.fetchOptions=function(){var t,e={headers:(t={Accept:"application/json"},t["Content-Type"]="application/json",t)},r=this.getJWT();return r&&(e.headers.Authorization=this.generateAuthHeader(r)),e},i.url=function(t){var e=this.endpoint||"/"+this.jsonapiType,r=""+this.fullBasePath()+e;return t&&(r=r+"/"+t),r},i.fullBasePath=function(){return""+this.baseUrl+this.apiNamespace},Object.defineProperty(i,"middlewareStack",{get:function(){if(this.baseClass){var t=this.baseClass._middlewareStack;if(this.beforeFetch||this.afterFetch){var e=this.beforeFetch?[this.beforeFetch]:t.beforeFilters,r=this.afterFetch?[this.afterFetch]:t.afterFilters;return new tn(e,r)}return t}return new tn},set:function(t){this._middlewareStack=t},enumerable:!0,configurable:!0}),i.scope=function(){return new xr(this)},i.first=function(){return this.scope().first()},i.all=function(){return this.scope().all()},i.find=function(t){return this.scope().find(t)},i.where=function(t){return this.scope().where(t)},i.page=function(t){return this.scope().page(t)},i.per=function(t){return this.scope().per(t)},i.extraParams=function(t){return this.scope().extraParams(t)},i.order=function(t){return this.scope().order(t)},i.select=function(t){return this.scope().select(t)},i.selectExtra=function(t){return this.scope().selectExtra(t)},i.stats=function(t){return this.scope().stats(t)},i.includes=function(t){return this.scope().includes(t)},i.merge=function(t){return this.scope().merge(t)},i.setJWT=function(t){this.credentialStorage.setJWT(t)},i.getJWT=function(){return this.credentialStorage.getJWT()},Object.defineProperty(i,"jwt",{get:function(){return this.getJWT()},set:function(t){this.setJWT(t)},enumerable:!0,configurable:!0}),i.generateAuthHeader=function(t){return'Token token="'+t+'"'},i.getJWTOwner=function(){return this.logger.warn("JSORMBase#getJWTOwner() is deprecated. Use #baseClass property instead"),this.baseClass},i.serializeKey=function(t){switch(this.keyCase.server){case"dash":return Hr(Gr(t));case"snake":return Gr(t);case"camel":return Wr(Gr(t),!1)}},i.deserializeKey=function(t){switch(this.keyCase.client){case"dash":return Hr(Gr(t));case"snake":return Gr(t);case"camel":return Wr(Gr(t),!1)}},i.prototype.destroy=function(){return a(this,void 0,void 0,function(){var e,r,n,i=this;return c(this,function(t){switch(t.label){case 0:e=this.klass.url(this.id),r=new h(this._middleware(),this.klass.logger),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.delete(e,this._fetchOptions())];case 2:return n=t.sent(),[3,4];case 3:throw t.sent();case 4:return this.klass.baseClass.store.destroy(this),[4,this._handleResponse(n,function(){i.isPersisted=!1})];case 5:return[2,t.sent()]}})})},i.prototype.save=function(u){return void 0===u&&(u={}),a(this,void 0,void 0,function(){var e,r,n,i,o,s,a=this;return c(this,function(t){switch(t.label){case 0:e=this.klass.url(),r="post",n=new h(this._middleware(),this.klass.logger),i=new _(this,u.with),this.isPersisted&&(e=this.klass.url(this.id),r="patch"),this.clearErrors(),s=i.asJSON(),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n[r](e,s,this._fetchOptions())];case 2:return o=t.sent(),[3,4];case 3:throw t.sent();case 4:return[4,this._handleResponse(o,function(){a.fromJsonapi(o.jsonPayload.data,o.jsonPayload,i.includeDirective),i.postProcess()})];case 5:return[2,t.sent()]}})})},i.prototype._handleResponse=function(e,r){return a(this,void 0,void 0,function(){return c(this,function(t){return u(this.klass,e),422===e.status?(o.apply(this,e.jsonPayload),[2,!1]):(r(),[2,!0])})})},i.prototype._fetchOptions=function(){return this.klass.fetchOptions()},i.prototype._middleware=function(){return this.klass.middlewareStack},i.prototype.resetRelationTracking=function(t){this._originalRelationships=this.relationshipResourceIdentifiers(Object.keys(t))},i.baseUrl="http://please-set-a-base-url.com",i.apiNamespace="/",i.keyCase={server:"snake",client:"camel"},i.strictAttributes=!1,i.logger=Xr,i.sync=!1,i.attributeList={},(i.currentClass=i)._jwtStorage="jwt",i.isJSORMModel=!0,e([en],i.prototype,"afterSync",void 0),e([en],i.prototype,"relationships",void 0),e([en],i.prototype,"klass",void 0),e([en],i.prototype,"_persisted",void 0),e([en],i.prototype,"_markedForDestruction",void 0),e([en],i.prototype,"_markedForDisassociation",void 0),e([en],i.prototype,"_originalRelationships",void 0),e([en],i.prototype,"_attributes",void 0),e([en],i.prototype,"_originalAttributes",void 0),e([en],i.prototype,"__meta__",void 0),e([en],i.prototype,"_errors",void 0),i}();(nn.prototype.klass=nn).initializeCredentialStorage();var on=function(t){return!!t&&(t.currentClass&&t.currentClass.isJSORMModel)},sn=function(){function t(t){this.isRelationship=!1,this.type=void 0,this.persist=!0,t&&(t.name&&(this.name=t.name),t.type&&(this.type=t.type),void 0!==t.persist&&(this.persist=!!t.persist))}return t.prototype.apply=function(t){Object.defineProperty(t.prototype,this.name,this.descriptor())},t.prototype.setter=function(t,e){t._attributes[this.name]=e},t.prototype.getter=function(t){return t.attributes[this.name]},t.prototype.descriptor=function(){var e=this;return{configurable:!0,enumerable:!0,get:function(){return e.getter(this)},set:function(t){e.setter(this,t)}}},t}(),an=function(t){return!!t.klass.sync&&((t.isPersisted||t.stale)&&!t.stored)},un=function(r){function t(t){var e=r.call(this,t)||this;return e.isRelationship=!0,t.jsonapiType&&(e.jsonapiType=t.jsonapiType),e.type&&(e._klass=e.type),e}return s(t,r),Object.defineProperty(t.prototype,"klass",{get:function(){return this._klass||(this._klass=hn(this,this.jsonapiType)),this._klass},enumerable:!0,configurable:!0}),t.prototype.getter=function(t){var e=t.relationships[this.name];return e&&an(e)&&delete t.relationships[this.name],t.relationships[this.name]},t.prototype.setter=function(t,e){e&&!e.hasOwnProperty("isRelationship")?(e instanceof nn||Array.isArray(e)||(e=new this.klass(e)),t.relationships[this.name]=e):null==e&&(t.relationships[this.name]=e)},t}(sn),cn=function(r){function t(t){var e=r.call(this,t)||this;return e.isRelationship=!0,t.jsonapiType&&(e.jsonapiType=t.jsonapiType),e.type&&(e._klass=e.type),e}return s(t,r),Object.defineProperty(t.prototype,"klass",{get:function(){return this._klass||(this._klass=hn(this,this.jsonapiType)),this._klass},enumerable:!0,configurable:!0}),t.prototype.getter=function(t){var e=t.relationships[this.name];if(!e)return this.setter(t,[]),t.relationships[this.name];for(var r=e.length;r--;)if(an(e[r])){t.relationships[this.name];e.splice(r,1)}return t.relationships[this.name]},t.prototype.setter=function(t,e){e&&!e.hasOwnProperty("isRelationship")?(e instanceof nn||Array.isArray(e)||(e=new this.klass(e)),t.relationships[this.name]=e):null==e&&(t.relationships[this.name]=e)},t}(sn),ln=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(un),pn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return s(e,t),e}(un),fn=function(t){var e={};return void 0!==t&&("string"==typeof t?e={jsonapiType:t}:(e={persist:t.persist,name:t.name},"string"==typeof t.type?e.jsonapiType=t.type:e.type=t.type)),e},hn=function(t,e){var r=t.owner.typeRegistry.get(e);if(r)return r;throw new Error('Unknown type "'+e+'"')},dn="undefined"!=typeof window,yn=!("production"===process.env.NODE_ENV),bn=function(t,e){vn(t),rn(t,e||{}),t.jsonapiType||t.isBaseClass||(t.jsonapiType=Nr(Gr(t.name)),yn&&dn&&Xr.warn('Inferring model jsonapiType as "'+t.jsonapiType+'".\nYou should explicitly set this on your model if targeting a minified code bundle.')),t.registerType()},vn=function(t){t.currentClass!==t&&t.currentClass.inherited(t)},gn=function(u){return function(t,e,s){var a,r=function(t,e){if(void 0===s){var r=Nr(Gr(e));a={jsonapiType:r}}else"string"==typeof s?a={jsonapiType:s}:on(s)?a={type:s}:(a={persist:s.persist,name:s.name},"string"==typeof s.type?a.jsonapiType=s.type:a.type=s.type);var n=new u(a);n.name||(n.name=e);var i,o=(i=t.constructor,vn(i),i);return(o.attributeList[e]=n).owner=t.constructor,n.apply(o),n.descriptor()};if(!on(t)||!e)return s=t,r;r(t.prototype,e)}},_n=gn(cn),mn=gn(ln),jn=gn(pn);t.JSORMBase=nn,t.Attribute=sn,t.attr=function(t){return t||(t={}),new sn(t)},t.hasMany=function(t){var e=fn(t);return new cn(e)},t.hasOne=function(t){var e=fn(t);return new ln(e)},t.belongsTo=function(t){var e=fn(t);return new pn(e)},t.Model=function(e){return function(t){return bn(t,e),t}},t.Attr=function(t,e,r){var n=new sn({name:e}),i=function(t,e){return vn(t),n.name||(n.name=e),(t.attributeList[e]=n).apply(t),n.descriptor()};if(!(on(t)||(o=t)&&on(o.constructor.currentClass)))return t&&(n=new sn(t)),function(t,e){return i(t.constructor,e)};if(!e)throw new Error("Must provide a propertyKey");var o,s=t;if(!on(s))return i(s.constructor,e);r&&(n=new sn(r)),i(s,e)},t.HasMany=_n,t.HasOne=mn,t.BelongsTo=jn,t.MiddlewareStack=tn,t.Scope=xr,Object.defineProperty(t,"__esModule",{value:!0})});
